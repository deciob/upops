// Generated by CoffeeScript 1.4.0

define(['backbone', 'libs/utils', 'libs/mapper', 'views/base', 'text!templates/world_map.html'], function(Backbone, utils, mapper, Base, template) {
  'use strict';

  var WorldMap;
  return WorldMap = Base.extend({
    el: "#world_map",
    initialize: function(options) {
      this.options = options || {};
      this.dispatcher = options.dispatcher;
      this.defaultMessage = "World Map (main visualisation)";
      this.message = this.options.message || this.defaultMessage;
      return this.dispatcher.on('onSlide', this.updateChart, this);
    },
    render: function(args) {
      var dimensions, ds, height, width, wr;
      wr = args[1][0];
      ds = args[0];
      dimensions = this._getViewDimensions();
      width = dimensions.width;
      height = dimensions.height;
      this.map = mapper();
      this.map.el(this.el);
      this.map.data({
        base: wr,
        overlay: ds
      });
      this.map.width(width);
      this.map.height(height);
      return this.map();
    },
    updateChart: function(year) {
      return this.map.updateOverlay(year);
    },
    _getViewDimensions: function() {
      return {
        height: utils.getMiddleHeight(),
        width: $(this.el).innerWidth()
      };
    }
  });
});
