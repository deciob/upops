// Generated by CoffeeScript 1.4.0

define(['jquery_ui', 'backbone', 'text!templates/top.html'], function($, Backbone, template) {
  'use strict';

  var Top;
  return Top = Backbone.View.extend({
    el: "#top",
    initialize: function(options) {
      this.setElement($(this.el));
      return this.dispatcher = options.dispatcher;
    },
    render: function(ds) {
      template = _.template(template);
      this.$el.html(template);
      return this.setCountryPicker(ds);
    },
    setCountryPicker: function(ds) {
      var countries, self;
      self = this;
      countries = this.getCountryList(ds);
      return $("#country_tags").autocomplete({
        source: countries,
        select: function(evt, ui) {
          return self.dispatcher.trigger('onCountrySelect', ui.item.value);
        }
      });
    },
    getCountryList: function(ds) {
      var countries;
      countries = [];
      ds.each(function(row) {
        return countries.push({
          label: row.Country,
          value: row.iso_a2
        });
      });
      return _.uniq(countries);
    }
  });
});
